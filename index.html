<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–∞–±–ª–∏—Ü—ã —Å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ–º –ª–∏—Å—Ç–æ–≤</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .tabs { display: flex; gap: 10px; margin-bottom: 20px; }
        .tab-link { padding: 10px; border: 1px solid #ccc; cursor: pointer; background: #f8f8f8; }
        .tab-link.active { background: #ddd; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        #sheetButtons { margin-bottom: 20px; }
        button { margin-right: 5px; padding: 8px; cursor: pointer; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { border: 1px solid #ccc; padding: 5px; text-align: left; }
        th { background: #f2f2f2; }
    </style>
</head>
<body>

    <!-- –í–∫–ª–∞–¥–∫–∏ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏ -->
    <div class="tabs">
        <div class="tab-link active" data-tab="tab1">–¢–∞–±–ª–∏—Ü–∞ 1</div>
        <div class="tab-link" data-tab="tab2">–¢–∞–±–ª–∏—Ü–∞ 2</div>
        <div class="tab-link" data-tab="tab3">–¢–∞–±–ª–∏—Ü–∞ 3</div>
    </div>

    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö -->
    <div id="tab1" class="tab-content active">
        <div id="sheetButtons"></div>
        <table id="dataTable1"></table>
    </div>
    <div id="tab2" class="tab-content">
        <div id="sheetButtons"></div>
        <table id="dataTable2"></table>
    </div>
    <div id="tab3" class="tab-content">
        <div id="sheetButtons"></div>
        <table id="dataTable3"></table>
    </div>

    <script>
        // API –∫–ª—é—á –∏ ID —Ç–∞–±–ª–∏—Ü
        const API_KEY = 'YOUR_GOOGLE_SHEETS_API_KEY';  // üîπ –ó–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ–π API –∫–ª—é—á
        const SPREADSHEET_IDS = {
            tab1: 'SPREADSHEET_ID_1',  // üîπ –ó–∞–º–µ–Ω–∏ –Ω–∞ ID –ø–µ—Ä–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã
            tab2: 'SPREADSHEET_ID_2',
            tab3: 'SPREADSHEET_ID_3'
        };

        let currentTab = 'tab1'; // –¢–µ–∫—É—â–∞—è –∞–∫—Ç–∏–≤–Ω–∞—è –≤–∫–ª–∞–¥–∫–∞
        let currentSheet = '';   // –¢–µ–∫—É—â–∏–π –∞–∫—Ç–∏–≤–Ω—ã–π –ª–∏—Å—Ç

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö –ª–∏—Å—Ç–æ–≤ –≤ —Ç–µ–∫—É—â–µ–π —Ç–∞–±–ª–∏—Ü–µ
        async function fetchSheetsList(spreadsheetId) {
            const response = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}?key=${API_KEY}`);
            const data = await response.json();
            
            const sheets = data.sheets.map(sheet => sheet.properties.title); // –ü–æ–ª—É—á–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è –ª–∏—Å—Ç–æ–≤
            createSheetButtons(sheets);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–Ω–æ–ø–æ–∫ –¥–ª—è –ª–∏—Å—Ç–æ–≤
        function createSheetButtons(sheets) {
            const container = document.querySelector(`#${currentTab} #sheetButtons`);
            container.innerHTML = ''; // –û—á–∏—Å—Ç–∫–∞ –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –Ω–æ–≤—ã—Ö –∫–Ω–æ–ø–æ–∫

            sheets.forEach(sheetName => {
                const button = document.createElement('button');
                button.textContent = sheetName;
                button.onclick = () => fetchData(SPREADSHEET_IDS[currentTab], sheetName, `dataTable${currentTab.charAt(3)}`);
                container.appendChild(button);
            });

            // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–≤—ã–π –ª–∏—Å—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            if (sheets.length > 0) {
                currentSheet = sheets[0];
                fetchData(SPREADSHEET_IDS[currentTab], currentSheet, `dataTable${currentTab.charAt(3)}`);
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Google Sheets
        async function fetchData(spreadsheetId, sheetName, tableId) {
            currentSheet = sheetName; // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—É—â–∏–π –∞–∫—Ç–∏–≤–Ω—ã–π –ª–∏—Å—Ç

            const response = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${sheetName}?key=${API_KEY}`);
            const data = await response.json();

            const rows = data.values;
            const table = document.getElementById(tableId);
            table.innerHTML = ''; // –û—á–∏—Å—Ç–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É –ø–µ—Ä–µ–¥ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ–º

            rows.forEach((row, rowIndex) => {
                const tr = document.createElement('tr');
                row.forEach(cell => {
                    const td = document.createElement(rowIndex === 0 ? 'th' : 'td'); // –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ - –∑–∞–≥–æ–ª–æ–≤–æ–∫
                    td.textContent = cell;
                    tr.appendChild(td);
                });
                table.appendChild(tr);
            });
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∫–ª–∞–¥–æ–∫
        function showTab(tabName) {
            currentTab = tabName; // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—É—â—É—é –≤–∫–ª–∞–¥–∫—É

            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');

            document.querySelectorAll('.tab-link').forEach(link => link.classList.remove('active'));
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ –ª–∏—Å—Ç–æ–≤ –¥–ª—è —Ç–µ–∫—É—â–µ–π –≤–∫–ª–∞–¥–∫–∏
            fetchSheetsList(SPREADSHEET_IDS[tabName]);
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –≤–∫–ª–∞–¥–æ–∫
        document.querySelectorAll('.tab-link').forEach(link => {
            link.addEventListener('click', () => showTab(link.getAttribute('data-tab')));
        });

        // –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ –∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–µ—Ä–≤–æ–π –≤–∫–ª–∞–¥–∫–∏
        showTab('tab1');
    </script>

</body>
</html>
